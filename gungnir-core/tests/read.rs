use deku::prelude::*;
use gungnir_core::{GungnirSignature, HashAlgorithm, SignatureAlgorithm, SignatureSlot};

#[test]
pub fn test_signature_read_1() {
	let bytes = include_bytes!("1.bin").to_vec();

	let (_, val) = GungnirSignature::from_bytes((bytes.as_ref(), 0)).unwrap();
	assert_eq!(
		val,
		GungnirSignature {
			version: 1,
			hash_algorithm: HashAlgorithm::Blake3,
			signature_amt: 2,
			signatures: vec![
				SignatureSlot {
					algorithm: SignatureAlgorithm::Ed25519,
					signature_len: 64,
					signature: vec![
						187, 231, 33, 227, 169, 232, 148, 182, 22, 242, 137, 234, 180, 78, 160, 92,
						42, 212, 48, 99, 246, 77, 1, 71, 148, 229, 7, 242, 171, 215, 72, 143, 28,
						138, 24, 166, 255, 138, 65, 129, 19, 55, 68, 19, 235, 232, 88, 186, 198,
						32, 13, 147, 30, 41, 85, 213, 148, 132, 143, 83, 151, 105, 237, 6
					]
				},
				SignatureSlot {
					algorithm: SignatureAlgorithm::Falcon512,
					signature_len: 655,
					signature: vec![
						57, 154, 183, 195, 62, 97, 236, 47, 29, 42, 241, 17, 189, 176, 109, 191,
						14, 21, 169, 76, 67, 52, 181, 231, 170, 251, 158, 250, 43, 65, 153, 190,
						212, 95, 58, 117, 171, 64, 108, 154, 246, 83, 97, 236, 80, 134, 54, 4, 83,
						123, 159, 14, 188, 190, 175, 185, 216, 242, 117, 205, 75, 169, 141, 76,
						209, 246, 197, 180, 235, 202, 184, 220, 69, 63, 195, 133, 78, 161, 105, 1,
						32, 209, 177, 242, 74, 252, 80, 198, 173, 220, 165, 66, 63, 174, 70, 246,
						179, 18, 251, 147, 143, 222, 183, 24, 134, 107, 54, 114, 147, 104, 34, 16,
						97, 250, 248, 70, 122, 83, 235, 121, 91, 201, 90, 139, 176, 33, 45, 6, 165,
						166, 248, 97, 40, 251, 158, 159, 90, 209, 18, 200, 209, 44, 123, 101, 91,
						63, 30, 177, 69, 164, 166, 54, 31, 44, 217, 250, 120, 55, 74, 42, 66, 204,
						145, 108, 203, 92, 236, 82, 21, 88, 57, 245, 159, 205, 150, 74, 242, 198,
						189, 49, 201, 67, 141, 252, 26, 8, 37, 71, 105, 160, 105, 29, 222, 60, 157,
						137, 83, 164, 101, 194, 235, 146, 84, 88, 54, 195, 136, 255, 201, 28, 126,
						28, 74, 150, 136, 160, 116, 8, 122, 32, 246, 243, 217, 39, 219, 166, 105,
						125, 246, 200, 50, 157, 153, 49, 81, 99, 65, 174, 228, 32, 88, 54, 125,
						250, 109, 82, 190, 164, 71, 174, 197, 180, 115, 206, 206, 220, 245, 235,
						55, 104, 171, 241, 165, 56, 241, 173, 62, 13, 49, 183, 109, 221, 58, 44,
						243, 33, 163, 72, 168, 133, 38, 175, 101, 118, 77, 79, 111, 90, 88, 83, 76,
						52, 29, 81, 32, 189, 148, 210, 112, 144, 111, 208, 117, 242, 87, 250, 71,
						213, 85, 105, 108, 194, 232, 29, 73, 167, 127, 218, 52, 232, 252, 18, 69,
						62, 106, 97, 14, 18, 217, 177, 222, 33, 34, 142, 110, 13, 4, 131, 0, 208,
						123, 96, 12, 150, 85, 18, 35, 157, 248, 44, 176, 166, 176, 51, 8, 45, 210,
						66, 72, 178, 58, 214, 218, 42, 40, 201, 64, 110, 167, 214, 236, 162, 215,
						38, 217, 74, 235, 219, 229, 27, 149, 143, 135, 95, 53, 80, 89, 35, 6, 208,
						230, 126, 94, 205, 9, 155, 46, 134, 145, 183, 132, 77, 108, 16, 253, 29,
						25, 2, 72, 242, 9, 106, 173, 153, 65, 62, 168, 105, 171, 170, 97, 30, 101,
						61, 133, 185, 244, 150, 108, 179, 225, 30, 167, 252, 240, 172, 174, 132,
						121, 224, 165, 71, 10, 72, 92, 150, 41, 212, 149, 64, 146, 218, 201, 17,
						56, 138, 216, 249, 97, 190, 217, 185, 202, 87, 189, 233, 170, 28, 78, 218,
						227, 100, 199, 220, 171, 117, 212, 154, 38, 77, 139, 170, 30, 201, 31, 239,
						199, 116, 191, 203, 249, 88, 245, 45, 199, 194, 79, 208, 103, 200, 202,
						205, 24, 21, 196, 159, 32, 106, 203, 47, 168, 84, 141, 52, 131, 83, 210,
						43, 216, 82, 33, 199, 163, 221, 72, 52, 84, 238, 70, 22, 199, 218, 102,
						143, 48, 178, 140, 66, 39, 131, 122, 84, 22, 103, 89, 41, 28, 86, 189, 12,
						52, 60, 221, 219, 123, 9, 71, 148, 245, 185, 196, 98, 217, 117, 170, 139,
						27, 174, 100, 178, 138, 45, 65, 8, 58, 220, 73, 96, 140, 47, 184, 187, 235,
						165, 191, 86, 232, 249, 231, 83, 157, 215, 97, 249, 10, 44, 178, 204, 151,
						125, 118, 137, 110, 87, 192, 98, 225, 12, 139, 142, 168, 172, 148, 218,
						140, 58, 114, 201, 83, 95, 100, 21, 165, 194, 212, 32, 232, 33, 50, 38,
						246, 79, 51, 52, 44, 248, 7, 57, 118, 222, 116, 184, 175, 66, 16, 231, 198,
						230, 169, 186, 40, 193, 76, 144, 136
					]
				}
			]
		}
	);
}
